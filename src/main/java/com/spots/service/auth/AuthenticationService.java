package com.spots.service.auth;

import com.mongodb.DuplicateKeyException;
import com.spots.common.GenericValidator;
import com.spots.common.input.LoginBody;
import com.spots.common.input.RegisterBody;
import com.spots.common.output.FacebookUserDTO;
import com.spots.common.output.GoogleUserDTO;
import com.spots.common.output.LoginResponse;
import com.spots.domain.Role;
import com.spots.domain.User;
import com.spots.domain.VerificationCode;
import com.spots.repository.UserRepository;
import com.spots.repository.VerificationCodeRepository;
import com.spots.service.common.SequenceGeneratorService;
import com.spots.service.user.InvalidUserException;
import jakarta.mail.MessagingException;
import jakarta.mail.internet.MimeMessage;
import jakarta.servlet.http.HttpServletRequest;
import java.time.Duration;
import java.time.LocalDateTime;
import java.util.ArrayList;
import java.util.Random;
import java.util.regex.Matcher;
import java.util.regex.Pattern;
import lombok.RequiredArgsConstructor;
import org.springframework.data.redis.core.RedisTemplate;
import org.springframework.http.HttpHeaders;
import org.springframework.mail.javamail.JavaMailSender;
import org.springframework.mail.javamail.MimeMessageHelper;
import org.springframework.security.authentication.AuthenticationManager;
import org.springframework.security.authentication.UsernamePasswordAuthenticationToken;
import org.springframework.security.crypto.password.PasswordEncoder;
import org.springframework.stereotype.Service;
import org.springframework.transaction.annotation.Transactional;
import org.springframework.web.reactive.function.client.WebClient;

@Service
@RequiredArgsConstructor
public class AuthenticationService {
    private final UserRepository userRepository;
    private final VerificationCodeRepository verificationCodeRepository;
    private final SequenceGeneratorService sequenceGeneratorService;
    private final PasswordEncoder passwordEncoder;
    private final JwtService jwtService;
    private final AuthenticationManager authenticationManager;
    private final GenericValidator<LoginBody> loginValidator = new GenericValidator<>();
    private final GenericValidator<RegisterBody> registerValidator = new GenericValidator<>();
    private final RedisTemplate<String, String> redis;
    private final JavaMailSender mailSender;

    @Transactional
    public void register(RegisterBody body) throws MessagingException {
        registerValidator.validate(body);
        var user =
                User.builder()
                        .id(sequenceGeneratorService.generateSequence(User.SEQUENCE_NAME))
                        .username(extractUsername(body.getEmail()))
                        .email(body.getEmail())
                        .role(Role.USER)
                        .password(body.getPassword())
                        .conqueredSpots(new ArrayList<>())
                        .build();

        user.setPassword(passwordEncoder.encode(user.getPassword()));
        user.setPicture(
                "data:image/png;base64,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");
        if (userRepository.existsUserByEmail(user.getEmail())) {
            throw new EmailTakenException("User with that email already exists");
        }
        sendVerificationEmail(user.getEmail());
        userRepository.insert(user);
    }

    @Transactional
    public LoginResponse login(LoginBody body) {
        loginValidator.validate(body);
        authenticationManager.authenticate(
                new UsernamePasswordAuthenticationToken(body.getEmail(), body.getPassword()));
        // get user
        var optionalUser = userRepository.findUserByEmail(body.getEmail());
        if (optionalUser.isEmpty()
                || !passwordEncoder.matches(body.getPassword(), optionalUser.get().getPassword()))
            throw new InvalidLoginCredenials("User with that email and password does not exist!");
        var user = optionalUser.get();
        if (!user.isEmailVerified()) throw new EmailNotVerifiedException("Email is not verified");
        user.setUsername(body.getEmail());
        var jwtToken = jwtService.generateToken(user);
        // return jwt token to client
        final var timeUntilNextRoll =
                user.getNextRandomSpotGeneratedTime() == null
                        ? Duration.ZERO
                        : Duration.between(LocalDateTime.now(), user.getNextRandomSpotGeneratedTime());
        return LoginResponse.builder()
                .accessToken(jwtToken)
                .timeUntilNextRoll(timeUntilNextRoll.getSeconds())
                .currentSpotId(user.getCurrentSpotId())
                .picture(user.getPicture())
                .id(user.getId())
                .build();
    }

    @Transactional
    public GoogleUserDTO loginWithGoogle(String accessToken) {
        WebClient webClient = WebClient.create();
        try {
            final var googleUserDTO =
                    webClient
                            .get()
                            .uri("https://www.googleapis.com/userinfo/v2/me")
                            .header("Authorization", "Bearer " + accessToken)
                            .retrieve()
                            .bodyToMono(GoogleUserDTO.class)
                            .block();
            final var userOptional = userRepository.findUserByEmail(googleUserDTO.getEmail());
            User user;
            if (!userOptional.isPresent()) {
                user =
                        User.builder()
                                .id(sequenceGeneratorService.generateSequence(User.SEQUENCE_NAME))
                                .username(extractUsername(googleUserDTO.getEmail()))
                                .email(googleUserDTO.getEmail())
                                .role(Role.USER)
                                .picture(googleUserDTO.getPicture())
                                .emailVerified(true)
                                .conqueredSpots(new ArrayList<>())
                                .build();
            } else {
                user = userOptional.get();
            }
            googleUserDTO.setJwtToken(jwtService.generateToken(user));
            final var timeUntilNextRoll =
                    user.getNextRandomSpotGeneratedTime() == null
                            ? Duration.ZERO
                            : Duration.between(LocalDateTime.now(), user.getNextRandomSpotGeneratedTime());
            googleUserDTO.setTimeUntilNextRoll(timeUntilNextRoll);
            googleUserDTO.setId(String.valueOf(user.getId()));
            googleUserDTO.setCurrentSpotId(user.getCurrentSpotId());

            if (userRepository.existsUserByEmail(user.getEmail())) {
                return googleUserDTO;
            } else {
                userRepository.insert(user);
            }
            return googleUserDTO;
        } catch (DuplicateKeyException e) {
            throw new UserAlreadyExistsException("User already exists!");
        } catch (Exception e) {
            throw new InvalidAccessTokenException("Invalid access token: " + accessToken);
        }
    }

    @Transactional
    public FacebookUserDTO loginWithFacebook(String accessToken) {
        WebClient webClient = WebClient.create();
        try {
            final var facebookUserDTO =
                    webClient
                            .get()
                            .uri(
                                    "https://graph.facebook.com/me?access_token="
                                            + accessToken
                                            + "&fields=id,name,email,picture.type(large)")
                            .retrieve()
                            .bodyToMono(FacebookUserDTO.class)
                            .block();

            final var userOptional = userRepository.findUserByEmail(facebookUserDTO.getEmail());
            User user;
            if (!userOptional.isPresent()) {
                user =
                        User.builder()
                                .id(sequenceGeneratorService.generateSequence(User.SEQUENCE_NAME))
                                .username(facebookUserDTO.getName())
                                .email(facebookUserDTO.getEmail())
                                .role(Role.USER)
                                .picture(facebookUserDTO.getPicture().getData().getUrl())
                                .emailVerified(true)
                                .conqueredSpots(new ArrayList<>())
                                .build();
            } else {
                user = userOptional.get();
            }
            facebookUserDTO.setJwtToken(jwtService.generateToken(user));
            facebookUserDTO.setId(user.getId());
            final var timeUntilNextRoll =
                    user.getNextRandomSpotGeneratedTime() == null
                            ? Duration.ZERO
                            : Duration.between(LocalDateTime.now(), user.getNextRandomSpotGeneratedTime());
            facebookUserDTO.setTimeUntilNextRoll(timeUntilNextRoll);
            facebookUserDTO.setCurrentSpotId(user.getCurrentSpotId());
            if (userRepository.existsUserByEmail(user.getEmail())) {
                return facebookUserDTO;
            } else {
                userRepository.insert(user);
            }
            return facebookUserDTO;
        } catch (DuplicateKeyException e) {
            throw new UserAlreadyExistsException("User already exists!");
        } catch (Exception e) {
            throw new InvalidAccessTokenException("Invalid access token: " + accessToken);
        }
    }

    public void logout(HttpServletRequest request) {
        final String authHeader = request.getHeader(HttpHeaders.AUTHORIZATION);
        var jwt = authHeader.substring(7);
        redis.opsForValue().set(request.getRemoteAddr(), jwt);
    }

    @Transactional
    public void verifyEmail(String code) {
        final var verificationCode =
                verificationCodeRepository
                        .findVerificationCodeByCode(code)
                        .orElseThrow(() -> new InvalidVerificationCodeException("Invalid verification code!"));
        final var user =
                userRepository
                        .findUserByEmail(verificationCode.getEmail())
                        .orElseThrow(
                                () -> new InvalidUserException("Verification code does not match any user"));
        user.setEmailVerified(true);
        userRepository.save(user);
    }

    public void sendVerificationEmail(String userEmail) throws MessagingException {
        MimeMessage message = mailSender.createMimeMessage();
        MimeMessageHelper helper = new MimeMessageHelper(message, true);

        helper.setTo(userEmail);
        helper.setFrom("bgspots@gmail.com");
        helper.setSubject("Spots Verification Code");

        String verificationCode = generateRandomCode(userEmail); // Generate code based on email
        String emailContent = "Your verification code is: <strong>" + verificationCode + "</strong>";

        helper.setText(emailContent, true);

        final var code =
                VerificationCode.builder()
                        .code(verificationCode)
                        .email(userEmail)
                        .id(sequenceGeneratorService.generateSequence(VerificationCode.SEQUENCE_NAME))
                        .build();
        verificationCodeRepository.insert(code);
        mailSender.send(message);
    }

    private String generateRandomCode(String userEmail) {
        // Use the user's email as part of the seed for generating the code
        String seed = userEmail + System.currentTimeMillis();

        // Generate the code using the seed
        String characters = "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";
        StringBuilder code = new StringBuilder();
        Random random = new Random(seed.hashCode());

        for (int i = 0; i < 6; i++) {
            code.append(characters.charAt(random.nextInt(characters.length())));
        }

        return code.toString();
    }

    private static String extractUsername(String emailAddress) {
        String regexPattern = "^(.+)@.+$";

        Pattern pattern = Pattern.compile(regexPattern);

        Matcher matcher = pattern.matcher(emailAddress);

        if (matcher.find()) {
            return matcher.group(1); // Group 1 contains the first part (username)
        } else {
            return null; // Return null if no match is found
        }
    }
}
